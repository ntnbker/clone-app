
%div.maintenance-list.container
  %div.main-column
    -@maintenance_requests.each do |maintenance_request|
      %div.row
        %div.image
          -if maintenance_request.maintenance_request_image != nil
            -maintenance_request.maintenance_request_image.images.each do |image|
              = image_tag(image.url.to_s)
        %div.info
          %div.row
            %h3.heading
              =link_to "#{maintenance_request.maintenance_heading}", maintenance_request_path(maintenance_request)
            %p.status
              =maintenance_request.action_status.maintenance_request_status
          %div.row
            %p.created_at
              = maintenance_request.created_at.strftime("%d %b. %Y")
            %p.type
              |
              = maintenance_request.service_type
          = react_component 'P', {:content => maintenance_request.maintenance_description}
          %p.address
            %i.fa.fa-map-marker
            = maintenance_request.property.property_address

%div.container
  -if current_user.agent? || current_user.agency_admin?  
    %h6
      Action Required
    %p
      =link_to "New Maintenace Requests", filtered_maintenance_requests_path(maintenance_request_filter:"Initiate Maintenance Request")
      =@new_maintenance_requests_count
      %br
      =link_to "Quote Received", filtered_maintenance_requests_path(maintenance_request_filter:"Quote Received")
      =@quotes_received_count
      %br
      =link_to "New Invoice", filtered_maintenance_requests_path(maintenance_request_filter:"New Invoice")
      =@new_invoice_count
      %br
      =link_to "Pending Payment", filtered_maintenance_requests_path(maintenance_request_filter:"Pending Payment")
      =@pending_payment_count
    %h6
      Awaiting Action 
    %p
      =link_to "Awaiting Owner Initiation", filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Owner Initiation")
      =@awaiting_owner_initiation_count
      
      %br
      =link_to "Awaiting Owner Instruction", filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Owner Instruction")
      =@awaiting_owner_instruction_count
      %br
      =link_to "Quote Requested", filtered_maintenance_requests_path(maintenance_request_filter:"Quote Requested")
      =@quote_requested_count
      %br
      =link_to "Awaiting Tradie Initiation", filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Tradie Initiation")
      =@awaiting_trady_initiation_count
      %br
      =link_to "Awaiting Tradie's Quote", filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Quote")
      =@awaiting_trady_quote_count
      %br
      =link_to "Awaiting Quote Approval", filtered_maintenance_requests_path(maintenance_request_filter:"Quote Received Awaiting Approval")
      =@awaiting_quote_approval_count
      %br
      =link_to "Quote Approved Tradie To Organise Appointment", filtered_maintenance_requests_path(maintenance_request_filter:"Quote Approved Tradie To Organise Appointment")
      =@trady_organise_appointment_count
      %br
      =link_to "Tradie To Confirm Appointment", filtered_maintenance_requests_path(maintenance_request_filter:"Tradie To Confirm Appointment")
      =@trady_confirm_appointment_count
      %br
      =link_to "Tenant To Confirm Appointment", filtered_maintenance_requests_path(maintenance_request_filter:"Tenant To Confirm Appointment")
      =@tenant_confirm_appointment_count
      %br
      =link_to "Landlord To Confirm Appointment", filtered_maintenance_requests_path(maintenance_request_filter:"Landlord To Confirm Appointment")
      =@landlord_confirm_appointment_count
      %br
      =link_to "Maintenance Scheduled - Awaiting Invoice", filtered_maintenance_requests_path(maintenance_request_filter:"Maintenance Scheduled - Awaiting Invoice")
      =@maintenance_scheduled_count          



        = will_paginate @maintenance_requests, :previous_label => '< Back', :next_label => 'Next >'

  %div.side-column
    = react_component('DropList', {:title => "Action Required",
                                   :content => [{title:'Maintenance Request', href:filtered_maintenance_requests_path(maintenance_request_filter:"Initiate Maintenance Request"),  count:@new_maintenance_requests_count},
                                                {title:'Quote Received', href:filtered_maintenance_requests_path(maintenance_request_filter:"Quote Received"), count:@quotes_received_count},
                                                {title:'New Invoice', href:filtered_maintenance_requests_path(maintenance_request_filter:"New Invoice"), count:@new_invoice_count},
                                                {title:'Pending Payment', href:filtered_maintenance_requests_path(maintenance_request_filter:"Pending Payment"), count:@pending_payment_count}]},
                                  {class:"action"})

    = react_component('DropList', {:title => "Awaiting Action",
                                   :content => [{title:'Awaiting Owner Initiation', href:filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Owner Initiation"), count:@awaiting_owner_initiation_count},
                                                {title:'Awaiting Owner Instruction', href:filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Owner Instruction"), count:@awaiting_owner_instruction_count},
                                                {title:'Quote Requested', href:filtered_maintenance_requests_path(maintenance_request_filter:"Quote Requested"), count:@quote_requested_count},
                                                {title:'Awaiting Tradie Initiation', href:filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Tradie Initiation"), count:@awaiting_trady_initiation_count},
                                                {title:'Awaiting Tradie`s Quote', href:filtered_maintenance_requests_path(maintenance_request_filter:"Awaiting Quote"), count:@awaiting_trady_quote_count},
                                                {title:'Awaiting Quote Approval', href:filtered_maintenance_requests_path(maintenance_request_filter:"Quote Received Awaiting Approval"), count:@awaiting_quote_approval_count},
                                                {title:'Quote Approved Tradie To Organise Appointment', href:filtered_maintenance_requests_path(maintenance_request_filter:"Quote Approved Tradie To Organise Appointment"), count:@trady_organise_appointment_count},
                                                {title:'Tradie To Confirm Appointment', href:filtered_maintenance_requests_path(maintenance_request_filter:"Tradie To Confirm Appointment"), count:@trady_confirm_appointment_count},
                                                {title:'Tenant To Confirm Appointment', href:filtered_maintenance_requests_path(maintenance_request_filter:"Tenant To Confirm Appointment"), count:@tenant_confirm_appointment_count},
                                                {title:'Landlord To Confirm Appointment', href:filtered_maintenance_requests_path(maintenance_request_filter:"Landlord To Confirm Appointment"), count:@landlord_confirm_appointment_count},
                                                {title:'Maintenance Scheduled - Awaiting Invoice', href:filtered_maintenance_requests_path(maintenance_request_filter:"Maintenance Scheduled - Awaiting Invoice"), count:@maintenance_scheduled_count}]},
                                  {class:"awaiting"})
